---
title: "Linear Regression Mini-competition"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r task}
# Your tasks is to create a linear model that best predicts the sentiment of the sentiment score for a news items’ headline.
```

```{r load-packages, message=FALSE}
library(tidyverse)
library(tidymodels)
library(corrplot)
library(caret)
library(GGally)
```

```{r load-data}
news <- read.csv("~/STA 631/Mini Comp/activity04-mini-competition/competition-files/data/news.csv")
```

```{r checking na values}
# Check for missing values
colSums(is.na(news))
```
```{r Data Preparation}
# Optionally, create dummy variables for categorical variables such as 'Topic'
news <- news%>% 
  mutate_at(vars(Topic), as.factor) %>%
  mutate(Topic = as.numeric(Topic))

# 1 - Economy
# 2 - Microsoft
# 3 - Obama
# 4 - Palestine
```


```{r Correlation Heatmap}
# Compute correlation matrix
cor_matrix <- cor(news %>% select(SentimentTitle, SentimentHeadline, Facebook, GooglePlus, LinkedIn))

# Plot correlation heatmap
corrplot(cor_matrix, method = "circle", type = "upper", order = "hclust", tl.col = "black", tl.srt = 45)

```

```{r Boxplots for Categorical Variables}
# Boxplot of SentimentHeadline by Topic
ggplot(news, aes(x = as.factor(Topic), y = SentimentHeadline)) +
  geom_boxplot() +
  labs(title = "Distribution of SentimentHeadline by Topic", x = "Topic", y = "SentimentHeadline")


```



```{r Visualization}
# Histogram of SentimentTitle
ggplot(news, aes(x = SentimentTitle)) + 
  geom_histogram(binwidth = 0.05, fill = "blue", color = "black") +
  ggtitle("Distribution of SentimentTitle")

# Histogram of SentimentHeadline
ggplot(news, aes(x = SentimentHeadline)) + 
  geom_histogram(binwidth = 0.05, fill = "red", color = "black") +
  ggtitle("Distribution of SentimentHeadline")
```



```{r EDA}
# Summary statistics
summary(news)

```

```{r}
# Correlations
correlations <- cor(news %>% select(SentimentTitle, SentimentHeadline, Facebook, GooglePlus, LinkedIn, Topic))
print(correlations)

```

```{r}
# Pair plots for relationships
pairs(news %>% select(SentimentTitle, SentimentHeadline, Facebook, GooglePlus, LinkedIn))
```


```{r data splitting}
set.seed(123)
training_indices <- createDataPartition(news$SentimentHeadline, p = 0.8, list = FALSE)
train_data <- news[training_indices, ]
test_data <- news[-training_indices, ]

```

```{r model fitting}
# Multiple linear regression model
model <- lm(SentimentHeadline ~ SentimentTitle + Facebook + GooglePlus + LinkedIn + Topic, data = train_data)
residuals <- resid(model)
fitted_values <- fitted(model)

# Check the summary for model insights
summary(model)
```


```{r Residual Plots}
ggplot() +
  geom_point(aes(x = fitted_values, y = residuals), alpha = 0.5) +
  geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
  labs(title = "Residuals vs Fitted Values", x = "Fitted Values", y = "Residuals")

```


```{r model evaluations}
predictions <- predict(model, test_data)
rmse <- sqrt(mean((predictions - test_data$SentimentHeadline)^2))
r_squared <- cor(predictions, test_data$SentimentHeadline)^2

print(paste("RMSE:", rmse))
print(paste("R²:", r_squared))

```

